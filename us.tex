\documentclass[kpfonts]{patmorin}
\listfiles
\usepackage{pat}
\usepackage{paralist}
\usepackage{dsfont}  % for \mathds{A}
\usepackage[utf8x]{inputenc}

\usepackage{graphicx}
\usepackage[noend]{algorithmic}

\usepackage{xcolor}
\definecolor{light-gray}{gray}{0.95}

\usepackage[normalem]{ulem}
\usepackage{cancel}
\usepackage{enumitem}

\usepackage[longnamesfirst,numbers,sort&compress]{natbib}

\usepackage{cleveref}

\newcommand{\snote}[1]{\fcolorbox{red}{yellow}{#1}}
\newcommand{\pnote}[1]{\ \newline\noindent\fcolorbox{red}{yellow}{\begin{minipage}{\textwidth}#1\end{minipage}}}
\setlength{\parskip}{1ex}

\title{\MakeUppercase{(Layered) Partitions versus Decompositions}}
\author{}

\DeclareMathOperator{\tw}{tw}
\DeclareMathOperator{\ltw}{ltw}
\DeclareMathOperator{\pw}{pw}
\DeclareMathOperator{\lpw}{lpw}
\DeclareMathOperator{\lhptw}{lhp-tw}
\DeclareMathOperator{\lhppw}{lhp-pw}

\title{\MakeUppercase{Optimal Unique-Superior Colouring of Planar Graphs}}
\author{Working Group}

\newcommand{\uqs}{\chi_2}
\newcommand{\hus}{\tilde{\chi}_2}
\begin{document}
% \begin{titlepage}
\maketitle

\begin{abstract}
  A \emph{unique-superior colouring} is a labelling of the vertices of a graph with integer colours so that the maximum label along any path of length at most 2 is unique.  We show that every $n$-vertex planar graph has a unique-superior colouring using $O(\log n/\log\log n)$ colours.
\end{abstract}
% \end{titlepage}

% \tableofcontents

% \newpage
% \pagenumbering{arabic}

\section{Introduction}

A sequence $s_0,\ldots,s_p$ over some total order $(S,<)$ is \emph{ranked} if $\max\{s_0,\ldots,s_p\}$ occurs exactly once in $s_0,\ldots,s_p$.  A colouring of a graph $G$ is a function $\varphi:V(G)\to S$.  A colouring $\varphi:V(G)\to S$ is an \emph{$\ell$-ranking} if, for every path $v_0,\ldots,v_k$ of length $k\le\ell$, $\varphi(v_0),\ldots,\varphi(v_k)$ is ranked. The $\ell$-ranking number $\chi_\ell(G)$ is the minimum integer $k$ such that $G$ has a $\ell$-ranking $\varphi:V(G)\to S$ with $|S|=k$.

The case $\ell=2$ has received special attention. A $2$-ranking is called a \emph{unique-superior colouring} (abbreviated \emph{us-colouring}) by \citet{karpas.neiman.ea:on} who prove the following result:

\begin{thm}[\cite{karpas.neiman.ea:on}]\label{trees}
    For every $n$-vertex tree $T$, $\uqs(T)\in O(\log n/\log\log n)$ and this is asymptotically optimal: for every $n\ge 1$ there exists an $n$-vertex tree $T$ with $\uqs(T)\in\Omega(\log n/\log\log n)$.
\end{thm}

The same authors show that $\uqs(G)\in O(\log n)$ for every $n$-vertex planar graph $G$ and leave the gap between this and the $\Omega(\log n/\log\log n)$ lower bound for trees as an open problem.  A consequence of the current paper is to close this gap:

\begin{thm}\label{planar}
    For every $n$-vertex planar graph $G$, $\uqs(G)\in O(\log n/\log\log n)$.
\end{thm}

Our proof of \cref{planar} makes use of a recent \emph{product structure theorem} of \citet{dujmovic.joret.ea:planar} which states that every planar graph $G$ is a subgraph of $H\boxtimes P$ where $H$ is an $8$-tree\footnote{A $k$-tree is an edge-maximal graph of treewidth $k$. Definitions appear later.}, $P$ is a path, and $\boxtimes$ denotes the strong graph product.  To apply this theorem, we generalize \cref{trees} as follows:

\begin{thm}\label{t-trees}
    For every fixed $t$ and every $n$-vertex $t$-tree, $\uqs(G) \in O(\log n/\log\log n)$.
\end{thm}

\cref{t-trees} can then be applied to the graph $H$ along with a simple product colouring which shows that $\uqs(H\boxtimes P)\le 3\uqs(H)$.  The remainder of this paper is organized as follows: \cref{sec:trees} reviews the proof of \cref{trees}. \cref{sec:t-trees} proves \cref{t-trees}.  \cref{sec:products} proves \cref{planar} as well as several generalizations, including graphs of bounded genus, apex-minor-free graphs, bounded-degree graphs from minor-closed families, and $k$-planar graphs.




\section{A Restatement of the Proof for Trees}
\seclabel{trees}

Let $H$ be a rooted tree.  The \emph{depth} $d_H(V)$ of a node $v\in H$ is the length of the path $P_T(v)$ from the root $r$ of $H$ to $v$.  A path $P$ in $H$ is \emph{vertical} if no two nodes in $P$ have the same depth, otherwise the path is \emph{humped}.  A node $a\in V(T)$ is a $T$-ancestor of $w\in V(T)$ if $a\in V(P_T(w))$.  A $T$-ancestor $a$ of $w$ is \emph{strict} if $a\neq w$.  If $a$ is a (strict) $T$-ancestor of $w$ then $w$ is a (strict) $T$-descendant of $a$.

A \emph{humped} us-colouring of $H$ is a proper colouring of $H$ in which, for every humped length-$2$ path $uvw$ in $H$, at least one of $\varphi(u)$ or $\varphi(w)$ is not equal to $\max\{\varphi(u),\varphi(v),\varphi(w)\}$.

\begin{lem}\label{product}
    If a rooted tree $H$ has a humped unique-superior colouring $\varphi:V(H)\to S$, then $H$ has a unique-superior colouring $\varphi':V(H)\to S\times\{0,1,2\}$.
\end{lem}

\begin{proof}
   For each $v\in V(H)$, let $\varphi'(v):=(\varphi(v), d_H(v)\bmod 3)$ and let $<$ denote lexicograph order over the set $S\times\{0,1,2\}$.  Since $\varphi$ is a humped us-colouring of $H$ we need only consider vertical paths of $H$.  But this is trivial since for every vertical path $uvw$ in $H$, $\varphi'(u)$, $\varphi'(v)$, and $\varphi'(w)$ are distinct.
\end{proof}

For integers $0\le i\le k$, let $f_k(i)$ be the smallest integer such that there exists an $f_k(i)$-node tree $H$ with root $r$ and some value $\ell \in\{i,\ldots,k\}$ such that $H$ does not have a humped unique-superior colouring $c:V(G)\to \{1,\ldots,k\}$.

\begin{lem}\label{recursion}
    For any integers $1\le  i\le k$, $f_k(i) \ge (k-i+1)\cdot f_k(i-1)$
    \[
        f_k(i) \le \begin{cases}
                    k & \text{if $i=1$} \\
                    (k-i+1)\cdot f(i-1) & \text{if $i>1$}
                 \end{cases}
    \]
\end{lem}

\begin{proof}
    The proof is by induction on $i$. First consider the base case $i=1$ and let $H$ be a $f(1)$-node tree $H$ with root $r$ such that, for some $\ell\in\{1,\ldots,k\}$, $H$ does not have a a humped unique superior colouring $\varphi:V(G)\to \{1,\ldots,k\}$.  Let $r_1,\ldots,r_d$ be the children of $r$.
    Then, for each $j\in\{1,\ldots,d\}$, and each $\ell'\in \{1,\ldots,k\}$, the subtree $H_j$ of $H$ rooted at $r_i$ has fewer than $f(1)$ nodes, so $H_j$ has a humped unique-superior colouring $\varphi:V(H_j)\to \{1,\ldots,k\}$ with $\varphi(r_j)=\ell'$.  Therefore, if $d \le k-1$, we can obtain a humped unique-superior colouring of $H$ as follows:
    \begin{enumerate}
        \item Set $\varphi(r):=\ell$.
        \item For each $j\in\{1,\ldots,d\}$, assign each $r_j$ a unique colour  $\varphi(r_j)\in\{1,\ldots,k\}\setminus\{\ell\}$ and extend $\varphi$ to a humped unique-superior colouring $\varphi:V(H_j)\to\{1,\ldots,k\}$ of $H_j$.
    \end{enumerate}
    If $d\le k-1$, then $|\{1,\ldots,k\}-\{\ell\}|=k-1\ge d$, so Step~2 will succeed.
    It is easy to check that $\varphi:V(H)\to\{1,\ldots,k\}$ is a humped unique-superior colouring of $H$ with $\varphi(r)=\ell$.  By definition, no such colouring exists, therefore it must be the case that $d> k-1$, so $H$ has at least $k+1$ vertices.

    Next consider some $i\in\{2,\ldots,k\}$.  Let $r_1,\ldots,r_d$ be the children of $r$ ordered so that the subtrees $H_1,\ldots,H_{d'}$ each have size at least $f(i-1)$ and the subtrees $H_{d'+1},\ldots,H_d$ each have size less than $f(i-1)$.  If $d'\le k-i$, then we obtain a humped unique-superior colouring of $H$ as follows:
    \begin{enumerate}
        \item Set $\varphi(r):=\ell$.
        \item For each $j\in\{d'+1,\ldots,d\}$ set $\varphi(r_j)=i-1$ and extend this to a humped unique-superior colouring of $H_j$.
        \item For each $j\in\{1,\ldots,d'\}$, assign each $r_j$ a unique colour $\varphi(r_j)\in\{i,\ldots,k\}\setminus\{\ell\}$ and extend this to a humped unique-superior colouring of $H_j$.
    \end{enumerate}
    If $d'\le k-i$ then Step~3 is always possible since $|\{i,\ldots,k\}\setminus\{\ell\}|=k-i$. Again, it is easy to check that $\varphi:V(H)\to[k]$ is a humped unique-superior colouring of $H$ with $\varphi(r)=\ell$.  By definition, no such colouring exists, so it must be the case that $d'>k-i$. Therefore $H$ has at least $d'\cdot f_k(i-1)\ge (k-i+1)\cdot f_k(i-1)$ vertices.
\end{proof}

Unravelling the recurrence in \cref{recursion} shows that $f_k(k)\ge 1\cdot2\cdot\cdots k=k!$.  In particular, for any $n < f_k(k)=k!$, every $n$ vertex rooted tree $H$ has a humped unique-superior colouring $\varphi(H)\to\{1,\ldots,k\}$. Combining this with \cref{product} yields:

\begin{thm}[\cite{karpas.neiman.ea:on}]
    Every tree $H$ with $n<k!$ vertices has a unique-superior colouring $\varphi:V(H)\to\{1,\ldots,3k\}$.
\end{thm}

Using Stirling's Approximation of $k!$ it easy to see that $n < k!$ for some $k\in\Theta(\log n/\log\log n)$, which is established \cref{trees}.

\section{A Less Obvious Restatement of the Proof for Trees}
\seclabel{trees}

\begin{lem}\label{tree-separator}
    For every integer $c\ge 1$ and for every $n$-vertex rooted tree $H$, there exists $S\subseteq V(H)$ such that
    \begin{inparaenum}[(i)]
        \item $H[S]$ is a tree that contains the root of $H$; \label{has-root}
        \item $H[S]$ has at most $c$ leaves; and \label{c-1-leaves}
        \item $H-S$ has no component larger than $n/(c+1)$. \label{max-component}
    \end{inparaenum}
\end{lem}

\begin{proof}
    Let $r$ be the root of $H$ and let $v_1,\ldots,v_n$ be the vertices of $H$ in the order they are encountered in a preorder traveral.  Let $L=\{v_{\lceil in/c\rceil}: i\in\{1,\ldots,c\}\}$.  Let $S:=\bigcup_{\ell\in L} V(P_H(\ell))$ so that $H[S]$ is the minimum spanning tree of $L\cup\{r\}$.  Clearly $S$ satisfies (\ref{has-root}).  Every leaf of $H[S]$ is contained in $L$, so $S$ satisifies (\ref{c-1-leaves}).  That $S$ satisfies (\ref{max-component}) follows from the fact that, for any $i\in\{1,\ldots,n\}$, $P_H(v_i)$ separates $v_1,\ldots,v_{i-1}$ from $v_{i+1},\ldots,v_n$ in the sense that, for every $1\le a\le b\le n$ the path from $a$ to $b$ in $H$ contains at least one vertex of $P_T(v_i)$.
\end{proof}

\begin{lem}\label{skinny-tree-colour}
    Let $1\le \ell \le n$ be integers, let $C$ be an $(\ell+1)$-element set of integers, let $\alpha\in C$, and let $H$ be an $n$-node tree rooted at $r\in v(H)$ having at most $\ell$ leaves.  Then $H$ has a humped us-colouring $\varphi:V(H)\to C$ in which $\varphi(r)=\alpha$.
\end{lem}

\begin{proof}
    The proof is by induction on $|V(H)|$. If $|V(H)|=1$ then $H$ has one node $r$ and the result is trivial.  Otherwise, let $r_1,\ldots,r_m$ be the children of $r$ and observe that $1\le m\le \ell$.  Set $\varphi(r):=\alpha$, as required and, for each $i\in\{1,\ldots,m\}$, set $\varphi(r_i)$ to the $i$th largest value in $C\setminus\{\alpha\}$, so that each child of $r$ is assigned a unique colour distinct from $r$. It is easy to check that this is a humped us-colouring of the star $H[\{r,r_1,\ldots,r_m\}]$ rooted at $r$ so all that remains is to colour the subtree $H_{r_i}$ rooted at $r_i$ for each $i\in\{1,\ldots,m\}$.  Applying induction to $H_{r_i}$ with $\alpha=\varphi(r_i)$ for each $i\in\{1,\ldots,m\}$ completes the proof.
\end{proof}


\begin{lem}\label{tree-algorithm}
    Let $1\le c\le k$ be integers and let $H$ be an $n$-vertex tree with $n\le k!/c!$, rooted at $r\in V(H)$. Then $H$ has a humped us-colouring $\varphi:V(H)\to\{0,\ldots,k\}$ with $\varphi(r)=k-c$.
\end{lem}

\begin{proof}
    The proof is by induction on $k-c$.  The base case, when $c=k$, occurs when $n\le k!/c!=1$ simply states that setting $\varphi(r)=0$ is gives a us-colouring of the 1-node tree whose only node is $r$.


    % The base case, when $c=k$ occurs when $n= k!/(k-1)!=k$.  In this case, $H$ has at most $k$ nodes and therefore, at most $k-1$ leaves.  The result then follows by applying \cref{skinny-tree-colour} with $C=\{1,\ldots,k\}$ and $\alpha=1$.

    For $1\le c<k$, let $S$ be the set described in \cref{tree-separator}.  Then $H[S]$ has at most $c$ leaves so, by \cref{skinny-tree-colour} with $\alpha=k-c$, $\varphi$ can be extended into a us-colouring $\varphi:S\to C$ of $H[S]$ using only the $c+1$ colours in $C:=\{k-c,\ldots,k\}$.  Now $H-S$ is a forest consisting of trees $H_{r_1},\ldots,H_{r_m}$ each having size at most $n/(c+1) \le k!/(c+1)!$ with roots $r_1,\ldots,r_m$, respectively.  For each $i\in\{1,\ldots,m\}$, apply induction on $H_{r_i}$ to extend $\varphi$ into a humped us-colouring $\varphi:V(H_{r_i})\to\{1,\ldots,k\}$ of $H_{r_i}$ in which $\varphi(r_i)=k-c$.  It is now straightforward to check that (because $\alpha(r_i)=k-c < k-c+1$ for each $i\in\{1,\ldots,m\}$) $\varphi$ is a humped us-colouring of $H$.
\end{proof}

Applying \cref{tree-algorithm} with $c=1$ and shifting $0,\ldots,k$ onto $1,\ldots,k+1$ gives:

\begin{cor}\label{tree-algorithm-ii}
    For every rooted tree $H$ with $n\le k!$ nodes, $\hus(H)\le k+1$.
\end{cor}

Combining \cref{tree-algorithm-ii} with \cref{product} gives the following
\begin{thm}[\cite{karpas.neiman.ea:on}]
    For every tree $H$ with $n\le k!$ vertices, $\uqs(H)\le 3(k+1)$.
\end{thm}


\section{Generalization to $t$-Trees}
\seclabel{t-trees}



A graph $H$ is a $t$-tree if $H$ is a clique of size $t$ or if it contains a vertex $v$ of degree $t$ whose neighbours form a clique and such that $H-\{t\}$ is a $t$-tree.  This recursive definition of $t$-trees implies that $V(G)$ can be ordered as $v_1,\ldots,v_n$ such that $v_1,\ldots,v_t$ form a clique and, for each $i\in\{t+1,\ldots,n\}$, $v_i$ is adjacent to exactly $t$ vertices among $v_1,\ldots,v_{i-1}$ which themselves form a clique.  We call $v_1,\ldots,v_n$ a \emph{construction order} for $H$.

A \emph{tree decomposition} of a graph $H$ is a sequence $\mathcal{T}:=(B_x:x\in V(T))$ of subsets of $V(H)$ called \emph{bags} indexed by the nodes of a tree $T$ and such that
\begin{inparaenum}[(i)]
    \item for each $v\in V(H)$, $T[\{x\in V(T):v\in B_x\}]$ is connected; and
    \item for each $vw\in E(H)$, there exists some $x\in v(T)$ such that $\{v,w\}\subseteq B_x$.
\end{inparaenum}
The \emph{width} of $\mathcal{T}$ is $\max\{|B_x|:x\in V(T)\}-1$. The \emph{treewidth} of $H$ is the minimum width of any tree decomposition of $H$.

It is not difficult to see that every $t$-tree has treewidth $t$.  For the remainder of this section, $H$ is a $t$-tree on $n\ge t+1$ vertices with construction order $v_1,\ldots,v_n$, $\mathcal{T}:=(B_x:x\in V(T))$ is a tree decomposition of $H$ in which every bag has size exactly $t+1$, $T$ is rooted some node $r$ with $B_r=\{v_1,\ldots,v_{t+1}$, and the decomposition has the following additional property:
\begin{inparaenum}[(i)]\setcounter{enumi}{2}
  \item for each node $x$ of $T$ with parent $y$, $|B_x\setminus B_y|=1$.
\end{inparaenum}
Note that this property implies that $|V(T)|=n-t$.

For each $v\in V(T)$ let $x_T(v)$ be the minimum-depth node $x\in V(T)$ such that $v\in B_x$.  A path $uvw$ in $H$ is \emph{vertical} if $x_T(u)$ is a strict $T$-ancestor of $x_T(v)$ which is a strict $T$-ancestor of $x_T(w)$.




% For each triple of integers $1\le i,t \le k$, $1\le i\le k$, let $f_{k,t}}(i)$.


\section{Applying the Product Structure Theorem}
\seclabel{products}


\section{Conclusions}
\seclabel{conclusion}


\bibliographystyle{plainnat}
\bibliography{us}

\end{document}
