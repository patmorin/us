\documentclass[kpfonts]{patmorin}
\listfiles
\usepackage{pat}
\usepackage{paralist}
\usepackage{dsfont}  % for \mathds{A}
\usepackage[utf8x]{inputenc}

\usepackage{graphicx}
\usepackage[noend]{algorithmic}

\usepackage{xcolor}
\definecolor{light-gray}{gray}{0.95}

\usepackage[normalem]{ulem}
\usepackage{cancel}
\usepackage{enumitem}

\usepackage[longnamesfirst,numbers,sort&compress]{natbib}

\usepackage{cleveref}

\newcommand{\snote}[1]{\fcolorbox{red}{yellow}{#1}}
\newcommand{\pnote}[1]{\ \newline\noindent\fcolorbox{red}{yellow}{\begin{minipage}{\textwidth}#1\end{minipage}}}
\setlength{\parskip}{1ex}

\DeclareMathOperator{\A}{\mathds{A}}
\DeclareMathOperator{\sn}{sn}
\DeclareMathOperator{\qn}{qn}
\DeclareMathOperator{\us}{us}

\renewcommand{\SS}{\mathcal{S}}

\newcommand{\Oh}{\mathcal{O}}


%Piotreks overloads
% \let\ge\geqslant
% \let\leq\leqslant
% \let\geq\geqslant
% \let\nleq\nleqslant
% \let\ngeq\ngeqslant
% \let\le\leqslant
%%Piotrek end

\newcommand{\aref}[1]{(X\ref{a:#1})}
\newcommand{\alabel}[1]{\label{a:#1}}

\newcommand{\itemref}[1]{(\ref{#1})}

\title{\MakeUppercase{(Layered) Partitions versus Decompositions}}
\author{}
% \date{}

\DeclareMathOperator{\tw}{tw}
\DeclareMathOperator{\ltw}{ltw}
\DeclareMathOperator{\pw}{pw}
\DeclareMathOperator{\lpw}{lpw}
\DeclareMathOperator{\lhptw}{lhp-tw}
\DeclareMathOperator{\lhppw}{lhp-pw}

\title{\MakeUppercase{Layered Treewidth versus Layered Partitions}}
\author{Prosenjit Bose, Vida DujmoviÄ‡, Pat Morin, and David R. Wood}

\pagenumbering{roman}

\begin{document}
\begin{titlepage}
\maketitle

\begin{abstract}
  These notes explore the relationship between layered treewidth and layered $H$-partitions.  They were first motivated by a desire to confirm that these two concept are, indeed, distinct.  In particular, while every graph with bounded layered partitions has bounded layered treewidth, the converse is not true.  Similar results hold for the path decomposition version of both parameters as well.
\end{abstract}
\end{titlepage}

\tableofcontents

\newpage
\pagenumbering{arabic}

\section{Introduction}

In recent years, the concept of layered treewidth has been used to make significant progress on a number of longstanding open problems on planar graphs and their relatives.  In particular, the fact that planar graphs have constant layered treewidth has been used to show that the queue-number and nonrepetitive chromatic number of $n$-vertex planar graphs are each $O(\log n)$ where the previous best bounds were $O(\sqrt{n})$ \cite{dujmovic:graph,dujmovic.joret.ea:nonrepetitive}.

More recently, the closely related concept of layered $H$-partitions has been used to settle both these of these questions (up to a constant).  In particular, the fact that every planar graph has a layered $H$-partition of constant layered width in which $H$ has constant treewidth has been used to show that queue number and nonrepetitive chromatic number of planar graphs are each upper bounded by a constant \cite{dujmovic.esperet.ea:planar,dujmovic.joret.ea:planar}.

The purpose of these notes is to explore the relationship between layered treewidth and layered $H$-partitions.  In particular, we separate these two notions by showing that there are graphs $G$ with layered treewidth 1 that do not have bounded layered partitions.  We also show an analogous result for layered pathwidth and layered $H$-partitions where $H$ has bounded pathwidth.

Let $\ltw(G)$ denote the layered treewidth of a graph $G$. Graph subdivisions are a key tool used to establish our results.  In particular, subdividing each edge of any graph $G$ $O(\ltw(G))$ times is sufficient to reduce its layered treewidth to 1, but there are graphs where this operation does not allow for a width-$w$ layered $H$-partition where $w$ and the treewidth of $H$ are both bounded by a constant.

This then motivates the study of subdivisions as a graph meta-parameter and as a means to relate different graph parameters.  For a particular graph parameter $f(\cdot)$ and some constant $c$, let $g_{c,f}(G)$ be the minimum number of subdivisions per edge required to make $G$ into a graph $G'$ for which $f(G')\le c$.  The result above shows that $g_{1,\ltw}(G)\in O(\ltw(G))$, but that this is not the case for the parameter $\lhptw(\cdot)$ related to layered $H$-partitions.  This gives interesting directions for future work.


\section{Definitions}

Any graph $G$ we consider is finite, undirected, simple, and connected.  We use standard graph theory terminology. See \citet{diestel:graph} for basic definitions and notation.

\subsection{Layerings}

A \emph{layering} $\mathcal{L}$ of a graph $G$ is a partition of $V(G)$ into a sequence of sets $L_0,\ldots,L_r$ such that for any edge $vw\in E(G)$, $v\in L_i$ and $w\in L_j$ implies $|i-j|\le 1$.  Two common layerings are the \emph{trivial layering} in which $L_0=V(G)$ and a \emph{breadth-first layering} rooted at some $r\in V(G)$ in which $L_i=\{w\in V(G): d_G(r,w)=i\}$, where $d_G(r,w)$ is the length of the shortest path, in $G$, from $r$ to $w$.

\subsection{Treewidth and Pathwidth}
A \emph{tree decomposition} $\mathcal{T}$ of a graph $G$ is a collection $(B_x:x(V(T)))$ of subsets of $V(G)$ called \emph{bags} indexed by the nodes of a tree $T$ such that
\begin{inparaenum}[(i)]
    \item for each $v\in V(G)$, the induced subgraph $T[\{x\in V(T):v\in B_x\}]$ is connected; and
    \item for each edge $vw\in E(G)$, there is at least one $x\in V(T)$ such that $\{v,w\}\subseteq B_x$.
\end{inparaenum}
The \emph{width} of a tree decomposition is the size of its largest bag, minus one.  The treewidth $\tw(G)$ of $G$ is the minimum width of any tree decomposition of $G$.

If $\mathcal{P}=(B_x:x\in V(P))$ is a tree decomposition of $G$ and $P$ is a path, then $\mathcal{P}$ is a \emph{path decomposition} of $G$.  The \emph{pathwidth} of a $G$ is the minimum width of any path decomposition of $G$.

\subsection{Layered Treewidth and Pathwidth}

A \emph{layered tree decomposition} of a graph $G$ consists of a pair $(\mathcal{L},\mathcal{T})$ where $\mathcal{L}=L_1,\ldots,L_r$ is a layering of $G$ and $\mathcal{T}=(B_x:x\in V(T))$ is a tree decomposition of $G$.  The (layered) \emph{width} of $(\mathcal{L},\mathcal{T})$ is the size of largest intersection between a layer and a bag, i.e., $\max\{|B_x\cap L_i|:x\in V(T), i\in\{1,\ldots,r\}\}$.  The \emph{layered treewidth} $\ltw(G)$ is the minimum width of any layered tree decomposition of $G$.

If $(\mathcal{L},\mathcal{P})$ is a layered tree decomposition of $G$ and $\mathcal{P}$ is a path decomposition, then $(\mathcal{P},\mathcal{L})$ is a \emph{layered path decomposition} of $G$.  The \emph{layered pathwidth} of $G$ is the minimum width of any layered path decomposition of $G$.

\subsection{Partitions and Layered Partitions}

An \emph{$H$-partition} of a graph $G$ is partition $\mathcal{H}=(B_x:x\in V(H))$ of $V(G)$ indexed by the nodes of some graph $H$ such that for any edge $vw\in E(G)$, $v\in B_x$ and $w\in B_y$ implies that $xy\in E(H)$.

For any graph $G$ and any partition $\mathcal{H}=(B_x:x\in X)$ of $V(G)$ indexed by some set $X$, the \emph{quotient graph} $H=G/P$ is the graph $V(H)=X$ and in which $xy\in E(G)$ if and only if there exists $vw\in E(G)$ such that $v\in B_x$ and $w\in B_y$.

A \emph{layered $H$-partition} $(\mathcal{H},\mathcal{L})$ of a graph $G$ consists of a layered partition $\mathcal{H}$ and a layering $\mathcal{L}$ of $G$.  The (layered) \emph{width} of $(\mathcal{H},\mathcal{L})$ is $\max\{|B_x\cap L|:x\in V(H), L\in\mathcal{L}\}$.

Layered $H$-partitions are most useful when both $w$ and $\tw(H)$ are bounded.  The following result shows that $w$ can always be reduced to 1 by increasing $\tw(H)$:

\begin{lem}\cite{dujmovic.joret.ea:planar}\label{width-one}
    If a graph $G$ has a width-$w$ layered $H$-partition, then $G$ has a width-$1$ layered $H'$-partition where $\tw(H')\le (\tw(H)+1)w-1$.
\end{lem}

In light of \cref{width-one}, it is natural to define the graph parameter
\[
    \lhptw(G):= \min\{\tw(H): \text{$G$ has a width-$1$ layered $H$-partition}\} \enspace .
\]
This definition also has an interpretation in terms of the \emph{strong graph product} $\boxtimes$:
\[
    \lhptw(G)=\min\{\tw(H) : G\subseteq H\boxtimes P \}
\]
where $\subseteq$ denotes the subgraph relationship, $H$ ranges over all graphs and $P$ is an infinite path. For details and definitions, see \citet{dujmovic.joret.ea:planar}.

\section{Graph Subdivisions}

A \emph{subdivision} of a graph $G$ is a graph $G'$ obtained by replacing each edge $vw$ of $G$ with a path $P_{vw}$ from $v$ to $w$ whose internal nodes have degree-$2$.  If $P_{vw}$ has exactly $s$ internal vertices for each $vw\in E(G)$, then $G'$ is the \emph{$s$-subdivision} of $G$.  If $P_{vw}$ has at most $s$ internal nodes for each $vw\in E(G)$ then $G'$ is a \emph{$(\le\!\!s)$-subdivision} of $G$.  For each $\star\in\{<,>,\ge\}$, a $(\star s)$-subdivision of $G$ is defined analagously, with the operator $\le$ replaced by $\star$.

\section{Separating $\ltw$ and $\lhptw$}

\begin{thm}\label{main}
  For any positive integer $k$, there exists a graph $G'$ such that $\ltw(G')=1$ and $\lhptw(G')=k$.  In particular, $G'$ is a $(\le\!\!k)$-subdivision of a graph $G$ with $\tw(G)=k$.
\end{thm}

\Cref{main} is the biggest separation between layered treewidth and layered $H$-partitions that we could possibly have.  The proof of \cref{main} follows almost immediately from \cref{LayeredTreewidthSubdivision} and \cref{LayeredPartitionSubdivision} below.


\subsection{Subdivisions Efficiently Reduce $\ltw$}


\begin{thm}
\label{LayeredTreewidthSubdivision}
For every graph $G$ with layered treewidth $k$,
\begin{enumerate}[label=(\alph*),font=\upshape]
\item there exists a $(\le\!\!2k-2)$-subdivision $G'$ of $G$ of layered
treewidth 1; and
\item if any subdivision $G'$ of $G$ has layered treewidth $c$ then some edge of $G$ is subdivided at least $k/c-1$ times in $G'$ (i.e., $G'$ is a $(>\!\!k/c)$-subdivision of $G$).
\end{enumerate}
\end{thm}

\begin{proof}
Let $(B_x:x\in V(T))$ be a tree-decomposition of $G$ and let
$(V_0,V_1,\dots)$ be a layering of $G$, such that $|B_x\cap V_i|\leq
k$ for each $x\in V(T)$ and $i\geq 0$.
First we prove (b). Let $c:V(G)\to\{0,1,\dots,k-1\}$ be a
$k$-colouring of $G$ such that all vertices in $B_x\cap V_i$, for some
$x\in V(T)$ and $i\geq 0$, get different colours. This is possible
since $\chi(G[V_i]) \leq \tw( G[V_i] )+1 \leq k$. Let $L_{ki+j} := \{v
\in V_i : c(v)=j\}$ for $i\geq 0$ and $j\in\{0,1,\dots,k-1\}$. Let
$G'$ be obtained from $G$ as follows. Consider each edge $e = vw$ of
$G$. Say $v\in V_i$ and $w\in V_{i'}$, and $v\in L_a$ and $w\in
L_{a'}$. Without loss of generality, $a<a'$. Then $a' \leq k(i'+1) - 1
\leq k(i+2)-1 \leq a + 2k-1$.
Replace $e$ by the path $(v, s_{e,a+1}, s_{e,a+2}, \dots, s_{e,a'-1},
w)$ in $G'$.
The number of division vertices is at most $a'-1-a \leq 2k-2$.
Put each $s_{e,a}$ in $L_a$. So $(L_1,L_2,\dots)$ is a layering of $G'$.
There is a bag $B_x$ containing both $v$ and $w$.
Add a leaf node to $T$ adjacent to $x$ with corresponding bag
$\{v, s_{e,i+1}, s_{e,i+2}, \dots, s_{e,i'-1}, w\}$.
We obtain a tree-decomposition of $G'$ with at most one vertex in each
layer and in each bag. Hence $\ltw(G')=1$.

%We now prove (b). Suppose that some $(\leq\!\!r)$-subdivision $G'$ of $G$
%has $\ltw(G') \leq c$. Observe that $G$ can be obtained from $G'$ by
%contracting $|V(G)|$
%pairwise disjoint connected subgraphs each with radius at most
%$\ceil{r/2}$. By \lemref{ContractBalls} (with $d= \ceil{r/2}$ and $H =
%G'$ and $H_0 = G$), we have $\ltw(G) \leq (2r+3)c$, implying  $r\geq
%(k/c - 3)/2$.

We now prove (b). Suppose that some $(\leq\!\!r)$-subdivision $G'$ of $G$
has $\ltw(G') \leq c$. Let $(B_x:x\in V(T))$ be a tree-decomposition
of $G'$ and let $(V_0,V_1,\dots)$ be a layering of $G'$ such that
$|B_x\cap V_i| \leq c$ for each $x\in V(T)$ and $i\geq 0$. Orient each
edge of $G$ arbitrarily. For each oriented edge $vw$ of $G$ and for
each division vertex $z$ of $vw$, let $\alpha(z):= v$. For each node
$x\in V(T)$, let $C_x$ be obtained from $B_x$ by replacing each
division vertex $z\in B_x$ by $\alpha(z)$. Observe that $(C_x:x\in
V(T))$ is a tree-decomposition of $G$. For $j\geq 0$, let $L_j:= V(G)
\cap ( V_{j(r+1)}\cup V_{j(r+1)+1} \cup \dots \cup V_{(j+1)(r+1)-1}
)$. Consider an edge $vw$ of $G$ with $v\in V_i$ and $w\in V_{i'}$ and
$i\leq i'$. Then $i' \leq i+ r+1$ since $vw$ is subdivided at most $r$
times. Say $v\in L_j$ and $w\in L_{j'}$. By definition, $j(r+1) \leq i
\leq (j+1)(r+1)-1$ and $j'(r+1) \leq i' \leq (j'+1)(r+1)-1$. Hence
$j'(r+1) \leq i' \leq i+r+1 \leq (j+1)(r+1)-1 + (r+1) = (j+1)(r+1) +
r$, implying $j'\leq j+1$. That is, $(L_0,L_1,\dots)$ is a layering of
$G$. Each layer $L_j$ contains at most $c(r+1)$ vertices in each bag
$C_x$. Thus $k=\ltw(G) \leq c(r+1)$, implying $r \geq k/c -1$.
\end{proof}

% \begin{lem}[\cite{DMW17}]\label{ContractBalls}
% If $H_1, \dots ,H_p$ are pairwise disjoint connected subgraphs of a
% graph $H$, each with radius at most some positive integer $d$, and
% $H_0$ is the graph obtained from $H$ by contracting each of
% $H_1,\dots,H_p$ into a single vertex, then $\ltw(H_0) \leq (4d + 1)
% \ltw(H)$.
% \end{lem}

Note that the proof of \cref{LayeredTreewidthSubdivision}(a) is easily
adapted to show that if $s_e\geq 2k-2$ for each edge $e\in E(G)$ and
$G'$ is the subdivision of $G$ in which each edge $e$ is subdivided
$s_e$ times, then $\ltw(G')\leq 2$. We omit these straightforward
details.

\citet{bannister.devanny.ea:track} proved that $\lpw(G) \leq \ceil{( \pw(G)+1)/2}$. An analogous proof shows that
$\ltw(G) \leq \ceil{( \tw(G)+1)/2}$.
\cref{LayeredTreewidthSubdivision}(a) then implies:

\begin{cor}\label{treewidth}\label{TreewidthSubdivision}
Every graph with treewidth $k$ has a $(\leq k)$-subdivision with
layered treewidth 1.
\end{cor}

We remark that \cref{treewidth} is tight, up to a small constant factor:
\begin{obs}
    Let $G'$ be any $(\le\!\!s)$-subdivision of the complete graph $K_{k+1}$.  Then $\ltw(G')\ge (k+1)/(2s+3)$. In particular, $\ltw(G')>1$ if $s < (k-2)/2$.
\end{obs}

\begin{proof}
    Let $(\mathcal{L},\mathcal{T})$ be a layered tree decomposition of $G'$.    Since $K_{k+1}$ has radius 1, $G'$ has radius at most $s+1$ and therefore $|\mathcal{L}|\le 2s+3$ layers.Â  Since $K_{k+1}$ has treewidth $k$, so does $G'$, so $\mathcal{T}$ has at least one bag $B_x$ of size at least $k+1$.  By the pigeonhole principle, $|B_x\cap L|\ge (k+1)/\mathcal{|L|}\ge (k+1)/(2s+3)$ for at least one $L\in\mathcal{L}$.
\end{proof}


\subsection{Subdivisions do not Efficient Reduce $\lhptw$}

A rougher version (with a more indirect proof) of our next theorem is already implied by existing results on centered colourings: \citet{joret.pilipczuk.ea:two} show that, for any positive integer $p$, there exists an integer $k\in \Theta(\sqrt{p})$, and a treewidth-$k$ graph $G$ such that the $6t$-subdivision $G'$ of $G$ does not have a $p$-centered colouring using fewer than $2^{c\sqrt{p}}$ colours for some $c>0$.  By \cref{treewidth}, $G'$ has layered treewidth at most $2$.


On the other hand, \citet{debski.felsner.ea:improved} (see also \citet{dujmovic.morin.ea:structure}) show that, for any $p$, any graph with a layered $H$-partition of layered width $w$ has a $p$-centered colouring using at most
\[
    w(p+1)p^{\binom{p+\tw(H)}{\tw(H)}}
\]
colours.  This implies that any width-$w$ layered $H$-partition of the graph $G'$ constructed by Joret, Pilipczuk, and Pitois must have
\[
    w(p+1)p^{\binom{p+\tw(H)}{\tw(H)}} > 2^{c\sqrt{p}} \enspace.
\]
This implies that $\tw(H) \in \Omega(\tw(G)/(w\log(\tw(G))))$.

The following theorem gives a more direct proof that yields the slightly stronger bound $\tw(H) \ge \tw(G)$, has no dependence on $w$, and places no restrictions on $s$ in terms of $\tw(G)$. In particular, any $(>\!\!p)$-subdivision of any graph $G$ has a $p$-centered colouring using $p+1$ colours so, for example, lower bounds on $p$-centered colourings cannot be used to show the existence of a graph $G$ whose $tw^2(G)$-subdivision $G'$ has $\lhptw(G')\in \omega(1)$.

\citet{dujmovic.joret.ea:planar} proved the case $s=0$ of the following theorem and the proof given below has a similar structure.

\begin{thm}\thmlabel{b}\label{LayeredPartitionSubdivision}
  There exists a function $f:\N^3\to\N$ such that, for any non-negative integers $s$, $w$, and $k$ there exists a graph $G=G_{s,k,w}$ such that $\tw(G)=k$ and, for any $(\le\!\!s)$-subdivision $G'$ of $G$, any width-$w$ layered $H$-partition of $G'$ has $\tw(H) \ge k$.  More specifically, $H$ contains a model of $K_{k+1}$ with at most $f(s, k, w)$ vertices.
\end{thm}

\begin{proof}
  The proof is by induction on $k$.  The case $k=0$ is trivial.  For $k=1$, let $G$ be a star with $(2s+3)w$ leaves.  Since $G$ is a tree, it has treewidth $k=1$.

  Let $G'$ be any $(\le\!\!s)$-subdivision of $G$.  The graph $G$ has radius 1 and therefore $G'$ has radius at most $s+1$.  Therefore, any layering of $G'$ has at most $2s+3$ layers.  Let $(\mathcal{L},\mathcal{H})$ be a width-$w$ layered $H$-partition of $G'$, let $\mathcal{H}:=(A_x:x\in V(H))$.  Since $|\mathcal{L}|\le 2s+3$ and $|A_x\cap L|\le w$ for each $L\in\mathcal{L}$, $|A_x|\le (2s+3)w$ for each $x\in V(H)$.  Since $G$ has $(2s+3)w+1$ vertices and $|A_x|\le (2s+3)w$ for each $x\in V(H)$, $H$ must have at least two vertices (so that we get at least two sets $A_x$ and $A_y$ in the $H$-partition).  Since $G$ is connected, $H$ contains the edge $xy$.  The edge $xy$ is a model of $K_2$ consisting of $f(s,2,w):=2$ nodes of $H$.  This completes the proof for the case $k=1$.

  Now consider any $k\ge 2$.  Let $Q$ be a graph (guaranteed to exist by the inductive hypothesis) such that $\tw(Q)\le k-1$ and any width-$w$ layered $H$-partition of any $(\le\!\!s)$-subdivision $Q'$ of $Q$ has $\tw(H)\ge k-1$.  Create the graph $G$ from $Q$ by starting with $X$ disjoint copies $Q_1,\ldots,Q_X$ of $Q$.  Next add a \emph{pseudo-apex} vertex $v$ and, for each $w\in V(Q_i)$ and each $i\in\{1,\ldots,X\}$, add $X$ distinct paths of length $2$ from $v$ to $w$.

  First we show that $\tw(G)\le k$.  Begin with any width-$(k-1)$ tree decomposition $(B_x:x\in V(T))$ of the disjoint union of $Q_1,\ldots,Q_X$.  Add $v$ to each bag of the decomposition.  For each vertex $w\in V(Q_i)$ and each $i,j\in\{1,\ldots,X\}$ find a bag $B_x$ that contains $w$, attach a leaf $x'$ to $x$ whose bag, $A_{x'}$, contains $v$, $w$, and the degree-2 vertex of the $j$th length-2 path from $v$ to $w$.  Each bag of this decomposition has size at most $\max\{3,k+1\}\le k+1$ and therefore $\tw(G)\le k$.

  Let $G'$ be a $(\le\!\!s)$-subdivision of $G$ and let $(\mathcal{L},\mathcal{H})$ be a layered $H$-partition of $G'$ with $\mathcal{H}:=(A_x:x\in V(H))$.  The radius of $G$ is $2$, so the radius of $G'$ is at most $2s+2$.  Therefore $|\mathcal{L}|\le 4s+5$.

  Let $x$ be the unique node of $H$ such that $v\in A_x$ and let $Q'_1,\ldots,Q'_X$ be the (possibly subdivided) copies of $Q_1,\ldots,Q_X$ that appear in $G'$.  Since $|A_x| \le (4s+5)w$, $A_x \cap V(Q'_j)\neq\emptyset$ for at most $(4s+5)w-1$ values of $j$.  For $X \ge (4s+5)w$, this implies that there is at least one $i\in\{1,\ldots,X\}$ such that $V(Q'_i)\cap A_x=\emptyset$.

  By induction, the subgraph $H_i$ of $H$ induced by the nodes $\tau\in V(H)$ such that $A_{\tau}\cap V(Q'_i)\neq\emptyset$ contains a $K_k$ minor whose model has at most $f(s,k-1,w)$ vertices.  Let $Y_1,\ldots,Y_k$ be subsets of $V(H_i)$ obtained from the model of $K_k$.  More precisely, $Y_1,\ldots,Y_k$ are pairwise disjoint, have total size at most $f(s,k-1,w)$, $H[Y_i]$ is connected for each $i\in\{1,\ldots,k\}$, and the vertices obtained by contracting each of $Y_1,\ldots,Y_k$ in $H$ form a clique in the resulting contracted graph.  Arbitrarily choose any $y_i'\in A_{y_i}$ for any $y_i\in Y_i$ (so that $y_i'\in V(G')$, and $y_i\in V(H)$).

  Summarizing, $|Y_1\cup\cdots\cup Y_k|\le f(s,k-1,w)$ and $|A_y|\le (4s+5)w$ for each $y\in Y_i$ and each $i\in\{1,\ldots,k\}$.  Therefore, for each $i\in\{1,\ldots,k\}$, at most $f(s,k-1,w)\cdot(4s+5)\cdot w$ of the $X$ paths from $y_i'$ to $v$ contain a vertex in $A_y$ for some $y\in Y_j$ and $j\in\{1,\ldots,k\}\setminus \{i\}$.

  If $X > f(s,k-1,w)\cdot(4s+5)\cdot w$ then $G'$ contains a path from $y_i'$ to $v$ that does not intersect any $A_{y_j}$ for any $y_j\in Y_j$ and any $j\in\{1,\ldots,k\}\setminus\{i\}$.  This means that $H$ contains a path from $y_i$ to $x$ that avoids every node in $\cup\{Y_1,..,Y_k\}\setminus Y_i$.  The length of this path is at most $2(s+1)$. This is true for each $i$ in $\{1,..,k\}$, so $H$ contains a $K_{k+1}$ minor. The model of this minor has at most $f(s,k,w):=2ks+k+1+f(s,k-1,w)$ vertices.
\end{proof}

\begin{rem}
    The function $f(s,k,w)$ in \thmref{b} satisfies the recurrence
    \[  f(s,k,w)
        = \begin{cases}
            2 & \text{for $k=1$} \\
            f(s,k-1,w) + 2ks +k+ 1 & \text{for $k\ge 2$}
        \end{cases}
    \]
    which resolves to $\Theta(sk^2)$.  This implies that the value $X$ used in the proof is in $\Theta((sk)^2w)$.  Therefore, the number of vertices in the graph $G=G_{s,k,w}$ satisfies the recurrence
    \[  S(s,k,w) \le
        = \begin{cases}
            (2s+3)w+1 & \text{for $k=1$} \\
            S(s,k-1,w) \cdot \Theta((sk)^2 w) & \text{for $k\ge 2$}
        \end{cases}
    \]
    which resolves to $\Theta((cw)^{k}s^{2k-1}(k!)^2)$ for some constant $c>1$.
\end{rem}


\subsection{Proof of \cref{main}}

\Cref{LayeredPartitionSubdivision} with $s=k$ and $w=1$ shows the existence of a treewidth-$k$ graph $G$ such that, for any $(\le\!\!k)$-subdivision $G'$ of $G$, $\lhptw(G')=k$.  By \cref{TreewidthSubdivision}, there exists a $(\le\!\!k)$-subdivision $G'$ of $G$ with $\ltw(G')=1$.  This particular graph $G'$ proves the first part of \cref{main} and the pair $(G,G')$ proves the second part.

\section{Separating $\lpw$ and $\lhppw$}

\begin{thm}\label{pathwidth-lower-bound}
    For each $k\in\N$, there exists a graph $G$ with $\lpw(G)=1$ and $\lhppw(G)=k$.
\end{thm}

For any tree $T$, $\lpw(T)=1$ as can be seen by using a breadth-first layering $\mathcal{L}$ of $T$ rooted at some vertex $r\in V(T)$ a path decomposition obtained by concatenating the path decompositions recursively obtained for the subtrees rooted at the children of $r$ and then adding $r$ to every bag.  \cref{pathwidth-lower-bound} then follows immediately from \cref{tree-lower-bound}, below, which shows that, for every $k$, there is a tree $T$ with $\lhppw(T)=k$.

Again, some version of \cref{tree-lower-bound} can be deduced from previous work. In particular, \citet{dvorak.huynh.ea:notes} show that any family $\mathcal{G}$ of graphs where $\lhppw(G)\le c$ for all $G\in\mathcal{G}$ has polynomial growth. The family $\mathcal{B}$ of binary trees does not have polynomial growth so, for every integer $c$, $\mathcal{B}$ includes a tree $T$ with $\lhppw(T)>c$ and, since $T$ is a tree, $\lpw(T)=1$.

\begin{lem}\label{tree-lower-bound}
  For each positive integer $k$, there exists a tree $T$ with $\lhppw(T)\ge k$.
\end{lem}

\begin{proof}
  The tree $T$ is a complete $d$-ary tree of height $h:=2k$ for some integer $d$ to be discussed shortly.  Let $r$ be the root of $T$.  We will prove (by induction on $h$) the following claim, from which the lemma follows easily: For every width-1 layered $H$-partition $(\mathcal{L},\mathcal{P})$ of $T$, where $\mathcal{P}=(B_x:x\in V(P))$, the graph $H=G/\mathcal{P}$ contains a complete binary tree $T'$ of height $h$ such that $r\in B_{r'}$ where $r'$ is the root of $T'$.  The base case $h=0$ is trivial.

  For $h>0$, let $B_{r'}$ be the bag that contains $r$.  Note that the diameter of $T$ is $2h$, so $|\mathcal{L}|\le 2h+1$.  Each of the $d$ children of $r$ is the root of a complete $d$-ary subtree of height $k-1$.
  Since $|B_x\cap L|\le 1$ for each $L\in\mathcal{L}$, there are at most $2h$ of these subtrees contains a node in $B_x$.  This leaves $d-2h$ children $r_1,\ldots,r_{b-2h}$ such that the subtree rooted at each $r_a$ does not contain any node in $B_x$.

  Applying induction on the subtree $T_a$ of $T$ rooted at $r_a$ for each $a\in\{1,\ldots,b-2h\}$, we find that $H$ contains a complete binary tree $T_a'$ of height $k-1$ rooted at a node $r_a'$ such that $r_a\in B_{r_a'}$.

  Consider the auxilliary graph $X$ with vertex set $V(X)=\{1,\ldots,r-2\}$ and in which $ab\in E(X)$ if and only if $T_a'$ and $T_b'$ share one or more nodes.  Since $T_a$ and $T_b$ are disjoint, this can only happen if, for some $x\in V(T_a')$, the bag $B_x$ contains a node of $T_a$ and a node of $T_b$.  Next note that, since $T$ has diameter at most $2k$, $|\mathcal{L}|\le 2h+1$ and therefore $|B_x|\le 2h+1$.  This implies that $X$ has maximum degree at most
  \[  \Delta = 2h(2^h-1)  \]
  since, for each of the $2^h-1$ nodes $x\in V(T_a')$, the bag $B_x$ contains at most $2h$ vertices not in $T_a$.  In particular, for $d> \Delta+2k+1$, this implies that the $(b-2k)$-vertex graph $X$ is not a clique.

  Therefore, there exists two trees $T_a'$ and $T_b'$ with no vertex in common.  The roots $r_a'$ and $r_b'$ contain the children $r_a$ and $r_b$ of $r$ and therefore the edges $r'r_a'$ and $r'r_b'$ are present in $H$. Therefore $H$ contains a complete binary tree of height $h$.

  It is well now, and not difficult to prove, that the pathwidth of a complete binary tree of height $h=2k$ is $h/2=k$.  Therefore, since $H$ contains a complete binary tree of height $h$ as a subgraph, $\pw(H)\ge k$.
\end{proof}

\begin{rem}
  \cref{tree-lower-bound} can be strengthened to show that there exists a constant $c$ such that every complete binary trees of height $c^k$ has $\lhppw(T)\ge k$.  The proof follows the same outline but rather than the considering the children of $d$ children of $r$, one consider the depth-$(1/2+\epsilon)c^{k}$ descendants of $r$ and proves the inductive statement with ``contains a complete binary tree'' replaced with ``contains a a subdivision of a complete binary tree.''
\end{rem}


\section{Future Work}

\subsection{A New Graph (Meta-)Parameter}

David suggests (and I like the idea, especially for a PhD student) of studying the question, how much must we subdivide a graph $G$ before a particular graph parameter $f(G)$ becomes small?

\begin{enumerate}
    \item Is it finite? For $f=\tw$ the answer is no.
    \item Is it a function of $|V(G)|$? For $f(G)=\min\{\tw(H): G\subseteq H\boxtimes P\}$ the answer is yes, as David explains below.
    \item Is it a function of $f(G)$?  For $f=\ltw$ the answer is yes.
\end{enumerate}

The result of \citet{joret.pilipczuk.ea:two} show that, for $f(G)=\min\{\tw(H): G\subseteq H\boxtimes P\}$, the number, $g_f(G)\in \Omega(\tw(G))$.  Our \cref{LayeredPartitionSubdivision} shows that, for every fixed $k$ and every $n$, there exits $n$-vertex graphs $G$ of treewidth $k$ with $g_f(G)=\omega_n(1)$.

\begin{verbatim}
The stream of consciousness continues ... Let f be an integer-valued graph
parameter. Let c_f be the minimum integer such that every graph G has a
subdivision G' with f(G') <= c_f. It is then natural to ask for the minimum
number g_f(G) such that  f(G') <= c_f  for some subdivision G' of G with at
most g_f(G) division vertices per edge. Then it is natural to ask what is g_f
tied to and to preferably determine g_f up to a constant factor. For example,
Vida and I proved that c_{qn} = 2 and that g_{qn}(G) = log qn(G) up to a
constant factor. My previous emails show that c_{ltw} = 1 and that
g_{ltw}(G) = ltw(G) up to a constant factor.  Now, let's consider the parameter
f(G) := min{ tw(H): G âŠ† H âŠ  P for some path P }. Since K_{1,\binom{n}{2}}  âŠ 
P_n contains a subdivision of every n-vertex graph, c_f = 1. The number of
division vertices per edge here is <= n. It would be interesting to get better
bounds on g_f. I suspect that tree-partition-width might become involved.
\end{verbatim}

\subsection{Applications}


\begin{itemize}
    \item Show a separation between applications of layered treewidth and layered $H$-partitions.  Graphs with bounded layered $H$-partitions have bounded queue number and bounded non-repetitive chromatic number.  Are there graphs of bounded layered treewidth with $\omega(1)$ queue number or non-repetitive chromatic number?
\end{itemize}

We already know of one such application that separates layered pathwidth $\lpw$ and layered $H$-partitions where $H$ has bounded pathwidth $\lhppw$. The application is the so-called \emph{unique-supremum} colouring number $\us(G)$ which asks for the minimum number of (numeric) colours required to colour the vertices of $G$ so that the maximum colour on any path of length 2 is unique.  For every $n$ there is an $n$-vertex tree $T$ such that $\us(T)\in\Omega(\log n/\log\log n)$, but every tree $T$ has $\lpw(T)=1$.  On the other hand, it is not hard to show that, for any graph $H$, $\us(H)\in O(\pw(H))$.  It is even easier to show that, for any graph $H$ and any path $P$, $\us(H\boxtimes P)\le 3\us(H)$.\footnote{Probably $\us(H_1\boxtimes H_2)\le \us(H_1)\cdot\us(H_2)$ for any graphs $H_1$ and $H_2$. Check!}  Therefore $\us(H\boxtimes P)\in O(\pw(H))$.




\noindent David Writes:
\begin{verbatim}
Regarding the question, "are there graphs of bounded layered treewidth
with â„¦(logn) queue number?" First, I would replace â„¦(logn) by
"unbounded". I guess a first candidate is the tw(G)-subdivision of G.
Vida and I proved that some O(log qn(G))-subdivision G' of G has
qn(G') <= 2. Wiechert proved that qn(G) <= 2^{tw(G)}-1. So some
O(tw(G))-subdivision G' of G has qn(G') <= 2. So G' does not seem to
be a good candidate. But if we could improve Theorem 1, then we might
get some traction since Vida and I proved that if G' is a subdivision
of G and qn(G') <= O(1), then some edge of G is subdivided â„¦(log
qn(G)) times in G' .

This all seems related to my email some months ago about separating sn
and qn, which I include below.

Finally, if f(G) := min{ tw(H): G âŠ† H âŠ  P } then our result separates
ltw and f; i.e. there exists a class of graphs with ltw=1 and
unbounded f. This is how I would resent the main result. We need a
name for f. And we should say that ltw(G) <= f(G)+1.

--------------------

Dear friends,

In Barbados, some of us were trying to decide whether there is a
polynomial upper bound on the queue-number in terms of the treewidth.
It occurred to me last night that if there is a super-polynomial lower
bound on the queue-number in terms of the tree-width then there exists
a class of graphs with bounded stack-number and unbounded queue-number
(which is an old open problem).

Assume that for each k there is a treewidth k graph G_k with qn(G_k)
>= k^{f(k)} for some function f with f(k) -> infinity. Let G'_k be the
ceil( 2 \log_2(k+1) )-subdivision of G_k. By Ganley-Heath and
Dujmovic-Wood, sn(G'_k) <= 3. Say qn(G'_k) = c. Again by
Dujmovic-Wood, we can unsubdivide to get that
k^{ f(k) } <= qn(G_k) <=  c^{ 4 \log(k+1))}, implying qn(G'_k) = c >=
2^{ f(k)/4}.  So G'_k has bounded stack-number (3) and unbounded
queue-number.

These O(log tw(G))-subdivisions of G have been an important example in
a number of settings recently. And it looks to be important here too.
Deciding whether there is a polynomial bound for qn in terms of tw has
further motivation.

Cheers,
- David

PS The results that I am using here:

Ganley-Heath: sn(G) <= tw(G)+1
Dujmovic-Wood: The ceil( 2 log sn(G) )-subdivision of any graph G has
a 3-stack-layout.
Dujmovic-Wood: If some s-subdivision of any graph G has a k-queue
layout, then G has a O(k^{2c})-queue layout. \\
(Pat: This should be O(k^{2s})), I think.
\end{verbatim}

\bibliographystyle{plainnat}
\bibliography{partsvsdecomps}

\end{document}
